<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="https://annekjohnson.com/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="https://annekjohnson.com/" rel="alternate" type="text/html" /><updated>2023-04-10T11:44:41+02:00</updated><id>https://annekjohnson.com/blog/feed.xml</id><title type="html">Anne K. Johnson</title><subtitle>Personal site of Anne K. Johnson</subtitle><entry><title type="html">Deploying a Python Twitter Bot on AWS Lambda</title><link href="https://annekjohnson.com/blog/2017/06/python-twitter-bot-on-aws-lambda/index.html" rel="alternate" type="text/html" title="Deploying a Python Twitter Bot on AWS Lambda" /><published>2017-06-11T23:26:04+02:00</published><updated>2017-06-11T23:26:04+02:00</updated><id>https://annekjohnson.com/blog/2017/06/python-twitter-bot-on-aws-lambda/python-twitter-bot-on-aws-lambda</id><content type="html" xml:base="https://annekjohnson.com/blog/2017/06/python-twitter-bot-on-aws-lambda/index.html"><![CDATA[<p>Once upon a time, I created a Twitter bot, <a href="https://twitter.com/poetryrobot">@poetryrobot</a>, to retweet poems every 30 minutes and send words of encouragement to people who tweet poetry. I <a href="https://github.com/annejohnson/poetryrobot">wrote the bot in Ruby</a> and deployed it as a continually running process on an AWS t2.micro EC2 instance. It ran free of charge within the AWS free tier usage limits for 12 happy months.</p>

<p>After 12 months of free-tier usage, EC2 starts to cost money, but <a href="https://aws.amazon.com/lambda/pricing/">AWS Lambda has a free tier that continues indefinitely</a>. I wanted to keep @poetryrobot running in the cheapest way possible, so I decided to migrate it from EC2 to Lambda. Because AWS Lambda does not support Ruby, I needed to port the bot to one of the supported languages: Java, C#, Javascript, or Python. I went with Python. I had a fun and interesting time working with Python and AWS Lambda, so I thought I would write up the adventure. <a href="https://github.com/annejohnson/poetryrobot_py">The full code for the ported bot is here</a>.</p>

<p>This process assumes that Python v3 and a compatible version of pip are pre-installed.</p>

<h1 id="step-1-bootstrap-the-project">Step 1: Bootstrap the project</h1>

<p>AWS Lambda allows you to write code directly into a web editor for simple scripts. However, if multiple files or external dependencies are needed, then development needs to occur in a directory whose files can then be zipped and uploaded to AWS Lambda.</p>

<p>I created a new code directory, <code class="language-plaintext highlighter-rouge">poetryrobot/</code>, containing a single Python file, <code class="language-plaintext highlighter-rouge">poetryrobot.py</code>.</p>

<p>Next, I picked out a Python Twitter package, <a href="https://github.com/bear/python-twitter">python-twitter</a>, and installed it into the code directory with the following:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># cd into the code directory, and then:</span>
pip <span class="nb">install </span>python-twitter <span class="nt">-t</span> <span class="si">$(</span><span class="nb">pwd</span><span class="si">)</span></code></pre></figure>

<p>The dependency needs to be installed in the code directory so that it can be included as part of the zip file.</p>

<h1 id="step-2-implement-the-bot">Step 2: Implement the bot</h1>

<p>I created a <code class="language-plaintext highlighter-rouge">credentials.json</code> file which contained the following information:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"consumer_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"consumer_secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"access_token_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"access_token_secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>In the <code class="language-plaintext highlighter-rouge">poetryrobot.py</code> file, I imported the dependencies I would use and loaded the credentials:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="n">twitter</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">random</span>

<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="s">'credentials.json'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">credentials</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">())</span></code></pre></figure>

<p>Then, still in <code class="language-plaintext highlighter-rouge">poetryrobot.py</code>, I implemented the following method to be the AWS Lambda entry point (the “main” method), and I implemented the methods it calls (like <code class="language-plaintext highlighter-rouge">poem_tweets</code> and <code class="language-plaintext highlighter-rouge">retweet_someone</code>):</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">_event_json</span><span class="p">,</span> <span class="n">_context</span><span class="p">):</span>
    <span class="n">tweets</span> <span class="o">=</span> <span class="nf">poem_tweets</span><span class="p">()</span>
    <span class="c1"># Retweet a poet more often than reply to a poet:
</span>    <span class="k">if</span> <span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mf">0.9</span><span class="p">:</span>
        <span class="nf">retweet_someone</span><span class="p">(</span><span class="n">tweets</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">reply_to_someone</span><span class="p">(</span><span class="n">tweets</span><span class="p">)</span>
    <span class="nf">follow_someone</span><span class="p">(</span><span class="n">tweets</span><span class="p">)</span>
    <span class="nf">follow_followers</span><span class="p">()</span></code></pre></figure>

<p>It’s important that this main method accepts two arguments, because AWS Lambda will pass it two arguments.</p>

<p>The full <code class="language-plaintext highlighter-rouge">poetryrobot.py</code> file can be seen <a href="https://github.com/annejohnson/poetryrobot_py/blob/master/poetryrobot.py">here</a>.</p>

<h1 id="step-3-create-the-zip-file">Step 3: Create the zip file</h1>

<p>I highlighted everything in the code directory (not including the code directory itself) and compressed it into a zip file.</p>

<h1 id="step-4-create-the-lambda-function">Step 4: Create the Lambda function</h1>

<p>I went to the AWS Lambda management console and clicked to create a new Lambda function. I selected the Blank Function template.</p>

<p>I clicked “Next” on the trigger screen to skip that step for now.</p>

<p>On the next screen, I set the runtime to Python 3.6 and named the function <code class="language-plaintext highlighter-rouge">poetryrobot</code>. I clicked to upload a zip file rather than type code inline, and I uploaded the generated zip file from Step 3. Then, I typed <code class="language-plaintext highlighter-rouge">poetryrobot.lambda_handler</code> (the name of the “main” method) into the handler field. I set a <code class="language-plaintext highlighter-rouge">lambda_basic_execution</code> role with CloudWatch log permissions. Finally, under “Advanced”, I increased the timeout from the default to 20 seconds.</p>

<h1 id="step-5-testing-the-lambda-function">Step 5: Testing the Lambda function</h1>

<p>With just these steps, the Lambda function was ready to roll. I clicked the “Test” button and saw activity on Twitter along with logs send to CloudWatch.</p>

<h1 id="step-6-scheduling-the-lambda-function">Step 6: Scheduling the Lambda function</h1>

<p>This is the final step! I went to the CloudWatch management console, navigated to the events » rules section, and clicked “Create rule”. On the next screen, I set the event source to “Schedule” and set a fixed rate of 30 minutes. Then, I set the target to the <code class="language-plaintext highlighter-rouge">poetryrobot</code> Lambda function. Finally, I named the CloudWatch rule <code class="language-plaintext highlighter-rouge">poetryrobot_event</code> and clicked to create it. From there, the bot was up and running on its schedule!</p>

<h1 id="thanks">Thanks!</h1>

<p>Thanks to <a href="http://blog.pythonicneteng.com/2016/09/make-twitter-bot-in-python-and-aws.html">this article</a> and <a href="http://joelgrus.com/2015/12/30/polyglot-twitter-bot-part-3-python-27-aws-lambda/">the one it references</a> for providing me with helpful Python and Lambda guidance.</p>]]></content><author><name></name></author><category term="programming" /><category term="python" /><category term="aws" /><summary type="html"><![CDATA[Once upon a time, I created a Twitter bot, @poetryrobot, to retweet poems every 30 minutes and send words of encouragement to people who tweet poetry. I wrote the bot in Ruby and deployed it as a continually running process on an AWS t2.micro EC2 instance. It ran free of charge within the AWS free tier usage limits for 12 happy months.]]></summary></entry><entry><title type="html">Antarctica</title><link href="https://annekjohnson.com/blog/2017/01/antarctica/index.html" rel="alternate" type="text/html" title="Antarctica" /><published>2017-01-07T16:28:45+01:00</published><updated>2017-01-07T16:28:45+01:00</updated><id>https://annekjohnson.com/blog/2017/01/antarctica/antarctica</id><content type="html" xml:base="https://annekjohnson.com/blog/2017/01/antarctica/index.html"><![CDATA[<p>This winter, I visited the otherworldly Antarctic peninsula. It was an adventure full of cold wind, zodiac boats, and penguin hops.</p>

<p>The idea for the trip came in May, 2015, when I brainstormed on what I wanted to have achieved in the next five years. At the top of the list was to visit all seven continents.</p>

<p>To visit my final two continents, South America and Antarctica, I booked a ticket for <a href="http://www.quarkexpeditions.com/en/antarctic/expeditions/antarctic-explorer-discovering-the-7th-continent" target="_blank">this Quark expedition</a>, a 10-day trip aboard the <em>Ocean Endeavour</em> that would sail me across the Drake Passage, from Argentina to Antarctica.</p>

<p>I had a wonderful time! Below are some stories covering moments that I don’t want to forget.</p>

<p><img src="/images/blog/antarctica/antarctica.JPG" alt="Antarctica" /></p>

<h1 id="waking-up-to-rocking">Waking up to Rocking</h1>

<p>Somewhere over the middle of the Drake Passage, I woke up in the pitch black of a windowless cabin, almost horizontal except for the fact that my head was 30 degrees below my feet. In a few seconds, the boat shifted, rotating the other way until my feet were 30 degrees below my head. A few more seconds, then another rotation.</p>

<p>“Is it supposed to be this bumpy? Should I be scared or calm?” I wondered. Hoping for the best, I went back to sleep and dreamt alongside the rocking.</p>

<p><img src="/images/blog/antarctica/seasickness_bags.JPG" alt="Seasickness Bags AKA Sacchetos Vomitos" class="alignright" /></p>

<p>In a few hours, I woke up to my alarm clock and took a uniquely interesting shower. The fact that I managed to not fall to my face is a deep and inexplicable mystery.</p>

<p>I then went to the dining hall for breakfast, hoping that by the power of the seasickness medicine I’d taken preemptively the day before, I’d be able to eat without problems. Success!</p>

<p>I was fortunate to never need one of the very fancy “sacchettos vomitos” that there were inescapably many of across the ship.</p>

<h1 id="the-first-iceberg">The First Iceberg</h1>

<p>“Good morning, Ladies and Gentlemen. Good morning.” Somewhere over the Drake Passage, the loudspeaker of the ship projected the buttery and meditative voice of the bearded, Alaskan expedition leader, Solan Jensen. Solan announced that we might expect to see our first iceberg in the near future, and that there would be a prize for the person on board who spots the first iceberg.</p>

<p><img src="/images/blog/antarctica/first_iceberg.JPG" alt="The First Iceberg" class="alignright" /></p>

<p>The icebergs in Drake waters generally come from the Weddell Sea, where they’ve broken off from Antarctic glaciers during summer melting. Their mighty size is incredible, and even more so after considering that most of their mass is underwater.</p>

<p>The first iceberg of the expedition was spotted by a lucky man from California. Believe me when I say I have a lot of photos of this particular iceberg. It was the moment when the trip changed from being somewhere in the middle of the sea to being in the Antarctic realm.</p>

<h1 id="clean-boots">Clean Boots</h1>

<p>The ship anchored a few hundred feet away from a site in Antarctica called Brown Bluff, where there are known penguin colonies. The loudspeaker tenderly announced that it was time for my group to “please go to the mud room to prepare for disembarkation”.</p>

<p>In the mud room, I put on outerware including a parka, waterproof pants, boots, and a life jacket.</p>

<p>Just before the door to disembark, I stepped into a tray of antimicrobial solution that’s designed to keep people’s boots from transmitting non-native bits and pieces to the continent. The rest of our outerwear had already been inspected for things like leaf matter in velcro.</p>

<p>After swishing around my boots in the solution, I proceeded to board the zodiac, a small, inflatable motorboat that seats about ten people. The zodiacs were used for cruising and for getting us from the ship to the continent.</p>

<p><img src="/images/blog/antarctica/zodiac_boat.JPG" alt="Zodiac Boat" /></p>

<h1 id="near-whale-encounters-and-struggles-with-sea-ice">Near-Whale Encounters and Struggles with Sea Ice</h1>

<p>“Over there!” Someone exclaimed, pointing off in the distance. I looked and saw a dark line emerge for a few moments.</p>

<p>The driver of the boat quietly redirected the motor and sent us that way. The dark specks of humpback whale got larger and larger, and we saw sprays of water as the whale surfaced to breathe.</p>

<p>Soon, we were very close, to the point where the whale tipping over the boat was in the realm of possibility. We floated quietly for a long time, watching the giant mammal at the interface of air and sea. The sight of this mighty beast in the beautiful Antarctic was unlike anything I’ve ever seen before.</p>

<p><img src="/images/blog/antarctica/whale.JPG" alt="Humpback whale" /></p>

<p>When it was time to return to the big ship, we needed to sail through thick sea ice. It was slow going because the driver had to run the motor low to avoid damaging its propellers in the icy conditions.</p>

<p><img src="/images/blog/antarctica/popped_zodiac.JPG" alt="Popped Zodiac" class="alignright" /></p>

<p>All of the sudden, there was a loud popping noise, and the person next to me jumped to the other side of the zodiac as the place where they formerly sat gave way, completely deflating. Sea ice had punctured that compartment of the boat. The driver was unphased and got us back to the big ship safely.</p>

<p>Back on the big ship, we discovered that our driver bears the nickname “Zodiac Killer”.</p>

<h1 id="penguin-curiosity-dining-and-jumping">Penguin Curiosity, Dining, and Jumping</h1>

<p>On land, I was walking up to where there was allegedly a snow petrel nest. On the way, I needed to cross a “penguin highway”, an established path that penguins use for getting from their stone nests to the ocean. We were instructed to stay 15 meters away from any wildlife, but wildlife was not bound by the same rule.</p>

<p>An adelie penguin came up to us and turned his head back and forth, looking at us with one eye and then the other. “He’s just checking you out,” an expedition guide said. Then the penguin returned to the highway and continued down toward the ocean, where he would swim out to find krill.</p>

<p><img src="/images/blog/antarctica/adelie_penguin.JPG" alt="Adelie Penguin" /></p>

<p><img src="/images/blog/antarctica/regurgitation.JPG" alt="Regurgitation" class="alignright" /></p>

<p>As I continued, I saw penguins sitting on nests delicately assembled of sea pebbles. Some were keeping eggs warm, and others were feeding their chicks by regurgitation. The only food source for penguins is ocean life, and chicks can’t swim in the cold waters for hunting without their adult feathers, so their parents share what they’ve caught.</p>

<p>I also noticed the spectacle of penguins jumping back up to their nests. Penguins manage to climb up to great heights by the power of one tiny hop at a time. They can’t fly, and they have stumpy little legs that are more helpful for navigating water than land. They’ve lost the ability to be quick on land during evolutionary history because they have no natural land predators. However, they do need access to land for the purpose of nesting, hence the journey from sea to nest. When they want to jump, they look at the ground, think really hard, and then take the teeniest of jumps. They often fall flat on their faces. Occasionally, I saw one give up entirely on using its legs and instead slide along on its belly. They are adorable to watch.</p>

<p><img src="/images/blog/antarctica/penguins.JPG" alt="Penguins on sea ice" /></p>

<h1 id="polar-plunge">Polar Plunge</h1>

<p>Early on in the trip, someone mentioned the polar plunge, which refers to jumping into Antarctic waters in merely one’s bathing suit. I felt a deep, sinking, fearful feeling. I knew it would probably be my only chance to ever do such a thing, but I knew it would be extremely cold and uncomfortable. I wanted to do it, but I also didn’t want to, and I was terrified.</p>

<p>As the trip unfolded, I talked to others about it. Some people were dead set on doing it. “I’ve already come to peace with it,” one person said. Others were dead set on <em>not</em> doing it. “I’ve got a minor heart condition and a major failure of courage,” someone said. A couple I met talked about it at length with me. They were on the trip after the lady had survived a near-death experience, and they were doing the plunge. I explained to her that I wanted to do it, but was afraid, and would appreciate any peer pressure she could give me. Her response was a brilliant, “Well, I’ve got metal in my body, and I’m doing it.”</p>

<p>Eventually, I realized that what I feared was not the act itself, but the anxiety of thinking about it so much. I resolved to not think about it and to instead just act, and survive. That’s what I did.</p>

<p><img src="/images/blog/antarctica/polar_plunge.JPG" alt="Me jumping into Antarctic waters" /></p>

<p>I felt happy triumph afterward! I’m glad to have done it. The water temperature was 0.5°C.</p>

<h1 id="a-good-day-in-the-blubber-department">“A Good Day in the Blubber Department”</h1>

<p><img src="/images/blog/antarctica/zodiac_in_narrow_channel.JPG" alt="Zodiac in a narrow channel" class="alignright" /></p>

<p>We were sailing in the zodiac and admiring the sides of glaciers until someone pointed out a group of seals on sea ice in the distance. The zodiac driver directed our boat toward them.</p>

<p>We coasted into a tiny channel in between land and sea ice, getting within 20 meters of the beasts. They were halfway sleeping, sitting up every now and then to scratch themselves or check us out with their eyes partially open. “They’re like giant cats,” our zodiac driver said.</p>

<p><img src="/images/blog/antarctica/seal.JPG" alt="Seal" /></p>

<p>Later in the day, when we were back on the ship and in a lecture about marine mammals by Marla, one of the expedition guides, she said, “Today was a good day in the blubber department!” The exhausted room was mostly silent, with a few woos and some clapping, and she laughed, adding, “Yes, you’re allowed to be happy about that!”</p>

<h1 id="interpretive-dance-and-dance-parties">Interpretive Dance and Dance Parties</h1>

<p>After a final beautiful Antarctic sunset, we began our return journey across the Drake.</p>

<p><img src="/images/blog/antarctica/antarctic_sunset.JPG" alt="Antarctic Sunset" /></p>

<p>A couple of expedition guides were hosting a trivia session in the ship’s lecture hall. Participants clumped into small teams and decided on team names. Questions asked included which metaphor Marla had used to describe the appearance of fur seals’ teeth and other precise details from lectures. After all the questions, the contest proceeded to the next stage.</p>

<p>The hosts asked a representative from each of the four teams with the highest scores to come up to the front. They announced their team names. “Whale sound”, “Quizbergs”, and “Poo-nami” (“poo-nami” is a word we’d learned from a video about the importance of whale excrement for krill life in the Antarctic). “We will decide the final winner through an interpretive dance that illustrates your team name,” the hosts said to the representatives.</p>

<p>The Quizbergs had a nice, simple dance that illustrated a still, cube-shaped structure that drifts along the sea. “Poo-nami” had a dance that was as amazing as you can possibly imagine it would be, including the representative’s pants coming off somewhat. And, last but not least, the Whale Sounds’ dance, delivered by a man with a red beard dressed in dark clothing, was a suggestive modern dance that evolved into pole dancing. “Okay, okay, that’s enough!” one of the hosts said, and added, “Some things you can’t unsee.” The audience was rolling in laugher, and one of my teammates turned to me and said, “Some people are extroverted.”</p>

<p>The winner, as decided by audience enthusiasm, was the Whale Sounds, and their prize was a round of drinks, which helped fuel the dance party that was coming later in the day.</p>

<p>The dance party began somewhere in the middle of the Drake Passage. A couple of young ladies I’d befriended were so excited because they’d been pushing for the dance party for days after noticing the disco ball in the front of the lecture room. They and other folks populated the dance floor immediately. I was sitting with some new friends close to the bar, talking and enjoying their company for one of the last times before the end of the trip. I’m shy, but I have been known to dance before in public settings, but I didn’t think it would happen this time around because there was no compelling enough peer pressure.</p>

<p>The tides turned when the lady from Monaco who I’d seen on the ship but had never talked to took my hand and walked me to the dance floor. I shrugged and waved goodbye to the people I was talking to, and then had a blast alongside the lady from Monaco and others as we danced to pop and hip-hop under the disco ball. Despite the rocking of the ship and the alcohol consumption, nobody fell to the floor dramatically. I certainly needed the exercise after having eaten dessert at least twice a day for the last week. Dancing one’s tail off over rocky waters of the Drake Passage is a pretty special experience and a lovely way to wrap up an extraordinarily special trip, full of incredible wildlife, adventures, breathtaking icy scenery, and fascinating new friends from all over the world.</p>]]></content><author><name></name></author><category term="antarctica" /><category term="travel" /><summary type="html"><![CDATA[This winter, I visited the otherworldly Antarctic peninsula. It was an adventure full of cold wind, zodiac boats, and penguin hops.]]></summary></entry><entry><title type="html">Publishing Elixir Packages</title><link href="https://annekjohnson.com/blog/2016/08/publishing-elixir-packages/index.html" rel="alternate" type="text/html" title="Publishing Elixir Packages" /><published>2016-08-21T19:28:33+02:00</published><updated>2016-08-21T19:28:33+02:00</updated><id>https://annekjohnson.com/blog/2016/08/publishing-elixir-packages/publishing-elixir-packages</id><content type="html" xml:base="https://annekjohnson.com/blog/2016/08/publishing-elixir-packages/index.html"><![CDATA[<p>You have some Elixir code in a Mix project and pushed to a Github repository. You’re code-complete-ish and ready to release your shiny and fabulous v0 to the world. Read on!</p>

<h3 id="documentation-make-it-easy-for-people-to-use-your-code">Documentation: Make it easy for people to use your code</h3>

<h4 id="give-some-love-to-your-readme">Give some love to your README</h4>

<p>The README is often the first aspect of your project that someone will see. So, make sure it answers all the basic questions a potential user would have. Ideally, a README includes the following information:</p>

<ul>
  <li>A <strong>brief summary</strong> of what the code does.</li>
  <li><strong>Installation instructions</strong>. How does a user install your code?
    <ul>
      <li>This content is auto-generated by Mix if you started your project with <code>mix new <project-name>&lt;/code&gt;, although it may need some tweaks.</project-name></code></li>
    </ul>
  </li>
  <li><strong>Usage instructions</strong>. An overview of how to use your project once it has been installed.
    <ul>
      <li>What are the main functions a user would be interested in? How are those functions used, and what do they return?</li>
    </ul>
  </li>
  <li><strong>Contributing</strong>. If you’re interested in contributions from others, you should write an invitation in the README and some instructions about how to get started - including how to run the test suite, etc. You should also include a link to a code of conduct.</li>
</ul>

<h4 id="generate-docs-with-exdoc">Generate docs with ExDoc</h4>

<p>Add the ex_doc dependency to your <code>mix.exs</code> file:</p>

<figure class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="p">{</span><span class="ss">:ex_doc</span><span class="p">,</span> <span class="s2">"&gt;= 0.0.0"</span><span class="p">,</span> <span class="ss">only:</span> <span class="ss">:dev</span><span class="p">}</span></code></pre></figure>

<p>Then, run <code>mix deps.get</code>. You can now generate documentation with the following command: <code>mix docs</code>. All of your modules and public methods will have rudimentary documentation already, but you can beef it up with <code>@doc</code> and <code>@moduledoc</code> tags. See the <a href="https://elixirschool.com/lessons/basics/documentation">Elixir School Documentation page</a> for demonstrations of how to use those tags in your code.</p>

<h3 id="publish-your-code-to-hex">Publish your code to Hex</h3>

<p>Follow the steps <a href="https://hex.pm/docs/publish">here</a> to register, add the needed metadata to <code>mix.exs</code>, and publish. 🚢</p>

<h3 id="publish-your-documentation-to-hexdocs">Publish your documentation to Hexdocs</h3>

<p>Make the lovely documentation you generated available to the world by running <code>mix hex.docs</code>.</p>]]></content><author><name></name></author><category term="programming" /><category term="elixir" /><summary type="html"><![CDATA[You have some Elixir code in a Mix project and pushed to a Github repository. You’re code-complete-ish and ready to release your shiny and fabulous v0 to the world. Read on!]]></summary></entry><entry><title type="html">Refactoring: DNA Patterns</title><link href="https://annekjohnson.com/blog/2016/05/refactoring-dna-patterns/index.html" rel="alternate" type="text/html" title="Refactoring: DNA Patterns" /><published>2016-05-24T20:46:08+02:00</published><updated>2016-05-24T20:46:08+02:00</updated><id>https://annekjohnson.com/blog/2016/05/refactoring-dna-patterns/refactoring-dna-patterns</id><content type="html" xml:base="https://annekjohnson.com/blog/2016/05/refactoring-dna-patterns/index.html"><![CDATA[<p>In the absence of a side project, yet with an urge to do some programming, I dug up some old side projects. I suspected I would find opportunities for refactoring. Indeed, I did! This post is about the adventure of refactoring my <a href="/dna-patterns">DNA Patterns</a> side project (<a href="https://github.com/annejohnson/dna-patterns">Github</a>).</p>

<h3 id="about-dna-patterns">About DNA Patterns</h3>

<p>DNA Patterns is a single page Javascript app that displays visualizations of DNA sequences. Each visualization is a simple background of animated circles, with the diameter of each circle corresponding to an A, T, G, or C nucleotide in a DNA sequence. The user can switch between a few different species to see how the sequence varies from species to species.</p>

<h3 id="old-implementation">Old Implementation</h3>

<p>The app was implemented as a single Javascript file, with everything happening in a single self-executing anonymous function. The Javascript had a few rigid dependencies:</p>

<ul>
  <li>The presence of a <code>#birdVis</code> element on the page</li>
  <li>The <code>window.onload</code> handler for app initialization</li>
  <li>The <a href="https://github.com/DmitryBaranovskiy/raphael">Raphael</a> library for rendering the circles</li>
</ul>

<p>Unfortunately, these dependencies were mixed throughout the code and not configurable, making the code not very reusable.</p>

<h3 id="refactoring-for-reusability--configurability">Refactoring for Reusability &amp; Configurability</h3>

<p>To make the code more reusable and configurable, I did the following:</p>

<ul>
  <li>Split up pieces of functionality into small classes, each focused on one thing</li>
  <li>Made the app instantiable at will (e.g. a call to <code>(new App()).start()</code> instead of a <code>window.onload</code> handler)</li>
  <li>Parameterized the <code>birdVis</code> ID string (e.g. <code>new App('birdVis')</code>), instead of letting it live in the core Javascript</li>
  <li>Isolated the communication with the Raphael library into a wrapper class</li>
</ul>

<p>As a result of those changes, I can now do the following easily:</p>

<ul>
  <li>Initialize the app at a different point in time than <code>onload</code></li>
  <li>Render the app in a different container element</li>
  <li>Replace the Raphael library (SVG-based) with a canvas-based library</li>
</ul>

<h3 id="refactoring-toward-the-modelviewcontroller-paradigm">Refactoring Toward the Model/View/Controller Paradigm</h3>

<p>I then composed the new classes within explicit view, model, and controller classes.</p>

<ul>
  <li>The <strong>model</strong> represents a collection of species (each one having a DNA sequence), plus the index of the selected species.</li>
  <li>The <strong>view</strong> handles rendering the UI controls and the data visualizations.</li>
  <li>The <strong>controller</strong> is the middle-man between the view and the model.
    <ul>
      <li>When the view sees that the user has clicked to select a new species, it communicates <em>only</em> with the controller. The controller then handles triggering updates on the model.</li>
    </ul>
  </li>
</ul>

<p>What happens after the model has changed? How does the view know to update the displayed visualization? I wanted a way for the view to know that the model has changed, but I didn’t want the model to have to communicate directly with the view.</p>

<h3 id="implementing-pubsub-as-a-way-for-the-model-to-communicate-abstractly-to-the-view">Implementing Pub/Sub as a Way for the Model to Communicate Abstractly to the View</h3>

<p>Enter the <strong>publish-subscribe pattern</strong> (pub/sub)!</p>

<p>Because the model is the authoritative source of exciting information, it behaves as a <strong>publisher</strong>, letting it subscribers know whenever an interesting change occurs. It behaves as a publisher by implementing a publisher interface (e.g. by defining methods like <code>publish</code> and <code>subscribe</code>). Whenever it changes in an interesting way, it calls the <code>publish</code> method to inform its subscribers of the change.</p>

<p>The <strong>subscribers</strong> are those who have subscribed themselves to the model using its <code>subscribe</code> method. When they receive the notification of the change, they can act however they wish. In this app, there is only one subscriber, the view. It acts by rendering the visualization for the newly selected species.</p>

<p>A major benefit of using this pattern is that I can now add new views easily. Say I wanted to add a widget in the foreground that contains a smaller visualization. With pub/sub, it’s simply a matter of creating a new type of view and subscribing it to the model. Both views will receive a notification whenever the model updates. So exciting!</p>]]></content><author><name></name></author><category term="programming" /><category term="refactoring" /><summary type="html"><![CDATA[In the absence of a side project, yet with an urge to do some programming, I dug up some old side projects. I suspected I would find opportunities for refactoring. Indeed, I did! This post is about the adventure of refactoring my DNA Patterns side project (Github).]]></summary></entry><entry><title type="html">Crash Course in Solving Software Bugs</title><link href="https://annekjohnson.com/blog/2015/08/crash-course-in-solving-software-bugs/index.html" rel="alternate" type="text/html" title="Crash Course in Solving Software Bugs" /><published>2015-08-16T18:22:00+02:00</published><updated>2015-08-16T18:22:00+02:00</updated><id>https://annekjohnson.com/blog/2015/08/crash-course-in-solving-software-bugs/crash-course-in-solving-software-bugs</id><content type="html" xml:base="https://annekjohnson.com/blog/2015/08/crash-course-in-solving-software-bugs/index.html"><![CDATA[<p>Much time on the job as a developer is spent not writing new code, but fixing bugs in old code. Bugs inevitably appear over time in an evolving codebase, and they need to be hunted down and cleaned up. Sometimes hunting them down is challenging. Here is a process for sniffing out the causes of enigmatic bugs in web applications. My examples involve Rails, but the concepts can be generalized to other web application environments.</p>

<h3 id="research-the-bug">Research the Bug</h3>
<ul>
  <li>Take what you know already (if anything) and begin a <strong>list of knowns</strong>. Add any information available from the bug report. You might have a list of knowns like:
    <ul>
      <li>The issue happens on the ‘Edit Account’ page.</li>
      <li>The issue only affects users who had a payment failure.</li>
    </ul>
  </li>
  <li>See if the bug is easily <em>reproducible</em>. If it is, add information such as the following to your list of knowns:
    <ul>
      <li><strong>Which methods are involved in the symptom</strong>. If the bug reveals itself from a web server action in Rails, you can determine some of the methods involved in the symptoms from the <code>rails server</code> output.</li>
      <li><strong>What preconditions need to be met for the bug to appear</strong>. Are there scenarios that <em>do not</em> reproduce the bug? Note any differences between those scenarios and the scenarios that <em>do</em> reproduce the bug.</li>
    </ul>
  </li>
  <li><strong>Find commonalities</strong> between records in the database known to have been involved with this bug. Do the affected records or their associated records share any unusual attribute values? Add any similarities you find to your growing list.</li>
  <li><strong>Do the affected records have any temporal overlap or patterns?</strong> Their <code>created\_at</code> and <code>updated\_at</code> timestamps or those of their associated records could suggest that this is a new problem, perhaps introduced by a code change around that time, or that the issue only happens at a certain time of day or certain day of the month. Add any information you gather here to your list. You might note information like:
    <ul>
      <li>The issue has been happening since Aug. 5.</li>
      <li>The issue seems to happen each day between 3 PM - 4 PM.</li>
    </ul>
  </li>
  <li>Draw on any other available resources to gather similar information. Other resources could include log files, data sent to external services, etc.</li>
</ul>

<p>At this point, you have a better understanding of the conditions that reproduce the bug. This is a major step. Next, you need to determine which part(s) of the code is related and how you need to change that code in order to fix the bug.</p>

<h3 id="finding-the-code-related-to-the-bug">Finding the Code Related to the Bug</h3>
<ul>
  <li>If you found any common values for attributes, search for parts of the codebase that set those attributes.
    <ul>
      <li>For example, if you found that affected user records share the value “unconfirmed” for their <code>status</code>, you can run searches for strings containing “unconfirmed” or “status =”.
        <ul>
          <li>I normally use <code>grep</code> to search codebases. Grep is a unix command that lets you run searches from the command line like <code>grep -rn "status =" .</code> (The <code>r</code> option says to recursively search in subdirectories; the <code>n</code> option says to show the line number.) You can pipe that into a further search for “unconfirmed” if you suspect that the value is being set directly, e.g. <code>grep -rn "status =" . | grep "unconfirmed"</code>.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>If you found temporal commonalities along the lines of “The issue has been happening since ___”, look at the commit history around that time. Look at both the commit messages and the code changes within the commits for any clues.</li>
  <li>If there were any temporal patterns like “The issue happens each day between 3 PM - 4 PM”, see if there are any scheduled jobs that run around that time. If so, the job code could be related.</li>
</ul>

<p>Study &amp; trace through these possibly related parts of the code. If you are able to <strong>reproduce the bug under a set of conditions, update the code with a fix, and then observe that the bug no longer happens under those same conditions</strong>, then congratulations - you have most likely squashed the bug!</p>

<h3 id="and-if-the-bug-is-still-mysterious">And, if the Bug is Still Mysterious…</h3>
<p>Some bugs, no matter how much you try to study and reproduce them locally, remain mystifying. With those, you might have reason to suspect that the bug is related to something that differs between your local environment and the environment where the bug was observed. There are 2 places to look to gather clues for these bugs:</p>

<ul>
  <li><strong>Inside the app</strong>. Search for any relevant differences between the config files in <code>config/environments/</code>, and look for <code>Rails.environment</code> conditionals throughout the codebase. Something you find here could explain why the bug manifests in one environment but not the other.</li>
  <li><strong>Outside the app</strong>. Search for any infrastructure-related or external-service-related causes in remote logfiles, in data sent to external services, etc.</li>
</ul>

<p>In the worst case scenario, the bug remains unreproducible, and the cause of the bug remains only a conjecture. However, if you have conducted research and eliminated a variety of other possible causes, and if you are putting in a hopeful-fix based on the information you’ve gathered, you should feel optimistic.</p>]]></content><author><name></name></author><category term="programming" /><summary type="html"><![CDATA[Much time on the job as a developer is spent not writing new code, but fixing bugs in old code. Bugs inevitably appear over time in an evolving codebase, and they need to be hunted down and cleaned up. Sometimes hunting them down is challenging. Here is a process for sniffing out the causes of enigmatic bugs in web applications. My examples involve Rails, but the concepts can be generalized to other web application environments.]]></summary></entry><entry><title type="html">Namespacing in Javascript</title><link href="https://annekjohnson.com/blog/2014/12/namespacing-in-javascript/index.html" rel="alternate" type="text/html" title="Namespacing in Javascript" /><published>2014-12-21T13:39:06+01:00</published><updated>2014-12-21T13:39:06+01:00</updated><id>https://annekjohnson.com/blog/2014/12/namespacing-in-javascript/namespacing-in-javascript</id><content type="html" xml:base="https://annekjohnson.com/blog/2014/12/namespacing-in-javascript/index.html"><![CDATA[<p>Without namespacing, Javascript becomes disorganized and insane. Because effectively namespacing in Javascript involves anonymous functions and closures, some of Javascript’s more confusing features, it’s not always practiced. The result is a global namespace cluttered with every single variable and helper function ever used. This is bad.</p>

<h3 id="namespacing-using-self-executing-anonymous-functions-and-closures">Namespacing Using Self-Executing Anonymous Functions and Closures</h3>

<p>A self-executing anonymous function looks like this: <code>(function() { ... })();</code>. Each time you use one, you are also using a closure. Here is what this type of namespacing looks like:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">onSaturn</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">jump</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Too heavy to jump.</span><span class="dl">"</span><span class="p">);</span> <span class="p">},</span>
    <span class="na">dropAnApple</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">*Splat*.</span><span class="dl">"</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">};</span>
<span class="p">})();</span>

<span class="nx">onSaturn</span><span class="p">.</span><span class="nf">jump</span><span class="p">();</span>
<span class="c1">// Too heavy to jump.</span>
<span class="nx">onSaturn</span><span class="p">.</span><span class="nf">dropAnApple</span><span class="p">();</span>
<span class="c1">// *Splat*.</span></code></pre></figure>

<p>The only variable we’ve added to the global scope is <code>onSaturn</code>, and through it, we have access to <code>jump</code> and <code>dropAnApple</code>.</p>

<h4 id="leveraging-the-power-of-the-closure">Leveraging the Power of the Closure</h4>

<p>A closure is created with the self-executing anonymous function. It enables us to declare variables that the namespaced functions can access.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">onSaturn</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">gravityConstant</span> <span class="o">=</span> <span class="mf">10.44</span><span class="p">;</span> <span class="c1">// unit: m/s^2</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">weight</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mass</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">mass</span> <span class="o">*</span> <span class="nx">gravityConstant</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">};</span>
<span class="p">})();</span></code></pre></figure>

<p>The closure enables selective exposure of its internal variables. In the above example, we are only exposing the <code>weight</code> function. The user is unable to access the internal variable <code>gravityConstant</code>.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">onSaturn</span><span class="p">.</span><span class="nf">weight</span><span class="p">(</span><span class="mi">40</span><span class="p">);</span>
<span class="c1">// 417.59999999999997</span>
<span class="nx">onSaturn</span><span class="p">.</span><span class="nx">gravityConstant</span><span class="p">;</span>
<span class="c1">// undefined</span></code></pre></figure>

<p>Exposing it is as simple as adding it to the returned object:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">onSaturn</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">gravityConstant</span> <span class="o">=</span> <span class="mf">10.44</span><span class="p">;</span> <span class="c1">// unit: m/s^2</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">weight</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mass</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">mass</span> <span class="o">*</span> <span class="nx">gravityConstant</span><span class="p">;</span> <span class="p">},</span>
    <span class="c1">// Allow access to gravityConstant</span>
    <span class="na">gravityConstant</span><span class="p">:</span> <span class="nx">gravityConstant</span>
  <span class="p">};</span>
<span class="p">})();</span></code></pre></figure>

<h4 id="dynamic-internal-variables">Dynamic Internal Variables</h4>

<p>Say an asteroid strike happens, and part of Saturn is blown away. This will alter Saturn’s gravitational constant. We need our <code>weight</code> function to always choose the correct value in its calculations.</p>

<p>Let’s create an <code>asteroidStrike</code> function that reduces the gravitational constant.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">onSaturn</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">gravityConstant</span> <span class="o">=</span> <span class="mf">10.44</span><span class="p">,</span>
      <span class="nx">asteroidStrike</span><span class="p">;</span> <span class="c1">// Declare it</span>

  <span class="c1">// Define it to reduce gravityConstant</span>
  <span class="nx">asteroidStrike</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">gravityConstant</span> <span class="o">=</span> <span class="nx">gravityConstant</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">weight</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mass</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">mass</span> <span class="o">*</span> <span class="nx">gravityConstant</span><span class="p">;</span> <span class="p">},</span>
    <span class="na">gravityConstant</span><span class="p">:</span> <span class="nx">gravityConstant</span><span class="p">,</span>
    <span class="c1">// Expose it</span>
    <span class="na">asteroidStrike</span><span class="p">:</span> <span class="nx">asteroidStrike</span>
  <span class="p">};</span>
<span class="p">})();</span></code></pre></figure>

<p>Like this, the weight function performs correctly even after an asteroid strike.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">onSaturn</span><span class="p">.</span><span class="nf">weight</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="c1">// 10.44</span>
<span class="nx">onSaturn</span><span class="p">.</span><span class="nf">asteroidStrike</span><span class="p">();</span>
<span class="nx">onSaturn</span><span class="p">.</span><span class="nf">weight</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="c1">// 7.83</span></code></pre></figure>

<p>Unfortunately, the exposed <code>gravityConstant</code> does not behave as expected after the asteroid strike. It always returns 10.44.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">onSaturn</span><span class="p">.</span><span class="nx">gravityConstant</span>
<span class="c1">// 10.44</span>
<span class="nx">onSaturn</span><span class="p">.</span><span class="nf">asteroidStrike</span><span class="p">()</span>
<span class="nx">onSaturn</span><span class="p">.</span><span class="nx">gravityConstant</span><span class="p">;</span>
<span class="c1">// 10.44</span></code></pre></figure>

<p>To resolve this, we should expose <code>gravityConstant</code> not as a number, but as a function that returns the value of the inner variable:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">onSaturn</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">gravityConstant</span> <span class="o">=</span> <span class="mf">10.44</span><span class="p">,</span>
      <span class="nx">asteroidStrike</span><span class="p">;</span>

  <span class="nx">asteroidStrike</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">gravityConstant</span> <span class="o">=</span> <span class="nx">gravityConstant</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">weight</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mass</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">mass</span> <span class="o">*</span> <span class="nx">gravityConstant</span><span class="p">;</span> <span class="p">},</span>
    <span class="c1">// Expose gravityConstant as a function</span>
    <span class="na">gravityConstant</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">gravityConstant</span><span class="p">;</span> <span class="p">},</span>
    <span class="na">asteroidStrike</span><span class="p">:</span> <span class="nx">asteroidStrike</span>
  <span class="p">};</span>
<span class="p">})();</span></code></pre></figure>

<p>Now, when we call the namespaced <code>gravityConstant()</code> function, we will always get the correct value.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">onSaturn</span><span class="p">.</span><span class="nf">gravityConstant</span><span class="p">()</span>
<span class="c1">// 10.44</span>
<span class="nx">onSaturn</span><span class="p">.</span><span class="nf">asteroidStrike</span><span class="p">()</span>
<span class="nx">onSaturn</span><span class="p">.</span><span class="nf">gravityConstant</span><span class="p">()</span>
<span class="c1">// 7.83</span></code></pre></figure>

<h4 id="nested-namespaces">Nested Namespaces</h4>

<p>After creating the main namespace, making nested namespaces is easy. See an example below:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">onSaturn</span><span class="p">.</span><span class="nx">north</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">temperature</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">temperature</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">temperature</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">};</span>
<span class="p">})();</span></code></pre></figure>

<p>Note that even though <code>onSaturn.north</code> is nested within the <code>onSaturn</code> object, it is created outside of the <code>onSaturn</code> closure. Therefore, <code>onSaturn.north</code> cannot access the private variables of <code>onSaturn</code>. Trying to access a private variable like <code>gravityConstant</code> will fail:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">onSaturn</span><span class="p">.</span><span class="nx">north</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">gravityConstant</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">gravityConstant</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">};</span>
<span class="p">})();</span>

<span class="nx">onSaturn</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nf">gravityConstant</span><span class="p">();</span>
<span class="c1">// ReferenceError: gravityConstant is not defined</span></code></pre></figure>

<p>This wraps up my examples. I hope you’re inspired to start namespacing your Javascript if you weren’t already. Happy closures!</p>]]></content><author><name></name></author><category term="programming" /><category term="javascript" /><summary type="html"><![CDATA[Without namespacing, Javascript becomes disorganized and insane. Because effectively namespacing in Javascript involves anonymous functions and closures, some of Javascript’s more confusing features, it’s not always practiced. The result is a global namespace cluttered with every single variable and helper function ever used. This is bad.]]></summary></entry><entry><title type="html">Getting Started With Landscape Painting</title><link href="https://annekjohnson.com/blog/2014/12/getting-started-with-landscape-painting/index.html" rel="alternate" type="text/html" title="Getting Started With Landscape Painting" /><published>2014-12-02T22:27:08+01:00</published><updated>2014-12-02T22:27:08+01:00</updated><id>https://annekjohnson.com/blog/2014/12/getting-started-with-landscape-painting/getting-started-with-landscape-painting</id><content type="html" xml:base="https://annekjohnson.com/blog/2014/12/getting-started-with-landscape-painting/index.html"><![CDATA[<p>Painting a tiny landscape the other week was really fun, so I decided to do more landscape painting.</p>

<p>I went shopping on Black Friday and bought detail brushes - including script liners, tiny rounds, fan brushes, and even a deerfoot stippler! I also bought a book called <a href="http://www.amazon.com/Paint-Landscapes-Acrylic-Lee-Hammond/dp/1600613098" target="_blank">Paint Landscapes in Acrylic</a> by Lee Hammond.</p>

<p>I was drawn to this book because the author doesn’t use reference photos in it. This keeps the focus on mastering broader landscape techniques. He also divides paintings up into 3 stages: the underpainting stage, the ‘awkward’ stage, and the finished stage. He demonstrates how to move a painting out of the awkward stage and into a beautiful finished stage.</p>

<p>I’ve been working through some example projects in the book. There are 16 total, and they gradually increase in complexity. Below are my paintings from the first 3 projects.</p>

<h2 id="clouds">Clouds</h2>

<p>This first project is a sunset skyscape, which focuses on techniques for painting clouds. I have a hard time painting clouds.</p>

<p><strong><em>5”x7” panel:</em></strong></p>

<p><img src="/images/blog/2014-12-02/orange_skyscape.jpg" alt="Orange Skyscape" /></p>

<h2 id="reflections-and-tree-silhouettes">Reflections and Tree Silhouettes</h2>

<p>Next is a sunset with a reflecting lake and some tree silhouettes. This was a great chance to practice using detail brushes to create trees. I loved working with all these bright oranges and yellows.</p>

<p><strong><em>5”x7” canvas:</em></strong></p>

<p><img src="/images/blog/2014-12-02/tree_sunset_lake_scene.jpg" alt="Tree Sunset Lake Scene" /></p>

<h2 id="blended-sunsets-and-leafy-trees">Blended Sunsets and Leafy Trees</h2>

<p>This one is a more detailed sunset with blended colors and leafy trees. Detail brushes like script liners are essential for painting skinny branches. I used a sponge for some of the leaf texture.</p>

<p><strong><em>5”x7” canvas:</em></strong></p>

<p><img src="/images/blog/2014-12-02/tree_sunset.jpg" alt="Tree Sunset" /></p>

<h2 id="into-the-wild">Into the Wild</h2>

<p>After doing those, I took on a project of my own, inspired by a reference photo from the <a href="http://www.wetcanvas.com" target="_blank">Wet Canvas</a> December Landscape Challenge. I’m very happy with how this turned out!</p>

<p><strong><em>5”x7” canvas:</em></strong></p>

<p><img src="/images/blog/2014-12-02/gray_lake_scene.jpg" alt="Gray Lake Scene" /></p>

<p>I look forward to doing more landscape painting.</p>]]></content><author><name></name></author><category term="art" /><category term="painting" /><category term="landscape" /><summary type="html"><![CDATA[Painting a tiny landscape the other week was really fun, so I decided to do more landscape painting.]]></summary></entry><entry><title type="html">Current Favorites in Ruby: Structs, .nil?, and Retries</title><link href="https://annekjohnson.com/blog/2014/11/current-favorites-in-ruby-structs-nil-retries/index.html" rel="alternate" type="text/html" title="Current Favorites in Ruby: Structs, .nil?, and Retries" /><published>2014-11-10T22:02:00+01:00</published><updated>2014-11-10T22:02:00+01:00</updated><id>https://annekjohnson.com/blog/2014/11/current-favorites-in-ruby-structs-nil-retries/current-favorites-in-ruby-structs-nil-retries</id><content type="html" xml:base="https://annekjohnson.com/blog/2014/11/current-favorites-in-ruby-structs-nil-retries/index.html"><![CDATA[<p>I’ve said it before, but I’ll say it again: I love Ruby! Here are some of my favorite Ruby features these days.</p>
<h2 id="struct">Struct</h2>
<p><code>Struct</code> is a quick way to create simple classes with a set of readable and writeable attributes.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">Node</span> <span class="o">=</span> <span class="no">Struct</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:key</span><span class="p">,</span> <span class="ss">:value</span><span class="p">,</span> <span class="ss">:next</span><span class="p">)</span>
<span class="c1"># ^ this is equivalent to:</span>
<span class="k">class</span> <span class="nc">Node</span>
  <span class="nb">attr_accessor</span> <span class="ss">:key</span><span class="p">,</span> <span class="ss">:value</span><span class="p">,</span> <span class="ss">:next</span>
<span class="k">end</span></code></pre></figure>

<p>Interacting with structures is exactly like interacting with the equivalent classes. They can be instantiated with any number of parameter arguments up to the number of attributes in <code>Struct.new</code>, with the nth parameter being assigned to the nth attribute. Any attributes not set during instantiation are nil.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">n</span> <span class="o">=</span> <span class="no">Node</span><span class="p">.</span><span class="nf">new</span>
<span class="c1"># =&gt; #&lt;struct Node key=nil, value=nil, next=nil&gt;</span>
<span class="n">n</span> <span class="o">=</span> <span class="no">Node</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:language</span><span class="p">,</span> <span class="s2">"French"</span><span class="p">)</span>
<span class="c1"># =&gt; #&lt;struct Node key=:language, value="French", next=nil&gt;</span>
<span class="n">n</span> <span class="o">=</span> <span class="no">Node</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:language</span><span class="p">,</span> <span class="s2">"French"</span><span class="p">,</span> <span class="no">Node</span><span class="p">.</span><span class="nf">new</span><span class="p">,</span> <span class="s2">"oops!"</span><span class="p">)</span>
<span class="c1"># ArgumentError: struct size differs</span></code></pre></figure>

<p>To make your structures do more than just store a set of attributes, you can pass them a block:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">Person</span> <span class="o">=</span> <span class="no">Struct</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:middle_name</span><span class="p">,</span> <span class="ss">:last_name</span><span class="p">)</span> <span class="k">do</span>
  <span class="k">def</span> <span class="nf">full_name</span>
    <span class="s2">"</span><span class="si">#{</span><span class="n">last_name</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">first_name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">middle_name</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">jane</span> <span class="o">=</span> <span class="no">Person</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"Jane"</span><span class="p">,</span> <span class="s2">"McSunshine"</span><span class="p">,</span> <span class="s2">"Doe"</span><span class="p">)</span>
<span class="n">jane</span><span class="p">.</span><span class="nf">full_name</span>
<span class="c1"># =&gt; "Doe, Jane McSunshine"</span></code></pre></figure>

<p>I’ve mostly used Structs for nested helper classes that support larger data structures, like entry structures in dictionaries or linked node structures in trees.</p>

<h2 id="nil">.nil?</h2>
<p><code>.nil?</code> is easy to take for granted, but it is a great example of the amazing simplicity in the Ruby language. In many other languages, some things are objects while other things are primitives. In Ruby, <strong>everything</strong> is an object - numbers, strings, and even nil itself. This means that with Ruby, you can test values like this:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">orange_hat_people</span> <span class="o">=</span> <span class="n">query_by_hat_color</span><span class="p">(</span><span class="s2">"orange"</span><span class="p">)</span>
<span class="nb">display</span><span class="p">(</span><span class="n">orange_hat_people</span><span class="p">)</span> <span class="k">unless</span> <span class="n">orange_hat_people</span><span class="p">.</span><span class="nf">nil?</span></code></pre></figure>

<p>Instead of like this (in Javascript):</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">orangeHatPeople</span> <span class="o">=</span> <span class="nf">queryByHatColor</span><span class="p">(</span><span class="dl">"</span><span class="s2">orange</span><span class="dl">"</span><span class="p">);</span>
<span class="nf">if </span><span class="p">(</span><span class="nx">orangeHatPeople</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">display</span><span class="p">(</span><span class="nx">orangeHatPeople</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<h5 id="the-workings-of-this-magic">The Workings of this Magic</h5>
<p>Ruby’s <code>Object</code> class, which all other classes inherit from, defines .nil? to return false. <code>NilClass</code> is the one class that overrides .nil? to return true.</p>

<h2 id="retry">Retry</h2>
<p>At work, I spend much of my time on a Rails application that communicates with various 3rd party services. Because mysteries happen, <code>retry</code> has become my friend. A <code>retry</code> inside of a <code>rescue</code> block causes re-execution of the contents in the <code>begin</code> block.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">begin</span>
  <span class="n">method_that_might_raise_error</span>
<span class="k">rescue</span> <span class="no">DerpException</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="k">retry</span>
<span class="k">end</span></code></pre></figure>

<p>This makes it easy in incorporate smart retry logic and failure alerts.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">attempts</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">begin</span>
  <span class="n">attempts</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="n">super_fun_stuff</span>
<span class="k">rescue</span> <span class="o">=&gt;</span> <span class="n">e</span>
  <span class="k">retry</span> <span class="k">if</span> <span class="n">attempts</span> <span class="o">&lt;</span> <span class="mi">5</span>
  <span class="n">alert_developer</span><span class="p">(</span><span class="s2">"exhausted retry attempts"</span><span class="p">)</span> <span class="k">if</span> <span class="n">attempts</span> <span class="o">&gt;=</span> <span class="mi">5</span>
<span class="k">end</span></code></pre></figure>

<p>My inbox and my workplace’s chat client thank <code>retry</code>. :)</p>
<h2 id="for-more-see-ruby-doc">For more, see Ruby-Doc</h2>
<p>Ruby is so pleasantly documented that I have read much of its documentation for fun. Luckily, there’s still an unending number of subtle, powerful features that I have yet to learn about, so I won’t get bored for a while. <a href="http://ruby-doc.org/" target="_blank">Check out the documentation here!</a></p>]]></content><author><name></name></author><category term="programming" /><category term="ruby" /><summary type="html"><![CDATA[I’ve said it before, but I’ll say it again: I love Ruby! Here are some of my favorite Ruby features these days. Struct Struct is a quick way to create simple classes with a set of readable and writeable attributes. Node = Struct.new(:key, :value, :next) # ^ this is equivalent to: class Node attr_accessor :key, :value, :next end Interacting with structures is exactly like interacting with the equivalent classes. They can be instantiated with any number of parameter arguments up to the number of attributes in Struct.new, with the nth parameter being assigned to the nth attribute. Any attributes not set during instantiation are nil. n = Node.new # =&gt; #&lt;struct Node key=nil, value=nil, next=nil&gt; n = Node.new(:language, "French") # =&gt; #&lt;struct Node key=:language, value="French", next=nil&gt; n = Node.new(:language, "French", Node.new, "oops!") # ArgumentError: struct size differs]]></summary></entry><entry><title type="html">Using Clojurescript to Make Charts with Raphael.js</title><link href="https://annekjohnson.com/blog/2014/10/using-clojurescript-to-make-charts-with-raphael/index.html" rel="alternate" type="text/html" title="Using Clojurescript to Make Charts with Raphael.js" /><published>2014-10-12T16:34:18+02:00</published><updated>2014-10-12T16:34:18+02:00</updated><id>https://annekjohnson.com/blog/2014/10/using-clojurescript-to-make-charts-with-raphael/using-clojurescript-to-make-charts-with-raphael</id><content type="html" xml:base="https://annekjohnson.com/blog/2014/10/using-clojurescript-to-make-charts-with-raphael/index.html"><![CDATA[<p>When I started using Clojurescript a few weeks ago, it was interesting learning how to translate between the two very different syntaxes of Javascript and Clojurescript. I’m going to share what I learned as I demonstrate how to use Clojurescript to make charts using <a href="http://g.raphaeljs.com/" target="_blank">Raphael.js’s chart library</a>. Code is available <a href="http://github.com/annejohnson/cljs-raphael" target="_blank">here</a>.</p>

<h2 id="setup-with-leiningen">Setup with Leiningen</h2>

<p>First, start a Clojure project using <a href="http://leiningen.org/" target="_blank">Leiningen</a> with the line <code class="language-plaintext highlighter-rouge">lein new cljs-raphael</code>. It’s possible to use the Clojurescript compiler directly, but lein is the way to go if you want to develop other parts your project in Clojure.</p>

<p>Go into the cljs-raphael directory and open up project.clj. Add a Clojurescript dependency: <code class="language-plaintext highlighter-rouge">[org.clojure/clojurescript "0.0-2173"]</code>, and add the Clojurescript plugin: <code class="language-plaintext highlighter-rouge">:plugins [[lein-cljsbuild "1.0.2"]]</code>. Your project.clj should look like this:</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="nf">defproject</span><span class="w"> </span><span class="n">cljs-raphael</span><span class="w"> </span><span class="s">"0.1.0-SNAPSHOT"</span><span class="w">
  </span><span class="no">:description</span><span class="w"> </span><span class="s">"Clojurescript/Raphael funsies"</span><span class="w">
  </span><span class="no">:url</span><span class="w"> </span><span class="s">"http://example.com/FIXME"</span><span class="w">
  </span><span class="no">:license</span><span class="w"> </span><span class="p">{</span><span class="no">:name</span><span class="w"> </span><span class="s">"Eclipse Public License"</span><span class="w">
            </span><span class="no">:url</span><span class="w"> </span><span class="s">"http://www.eclipse.org/legal/epl-v10.html"</span><span class="p">}</span><span class="w">
  </span><span class="no">:dependencies</span><span class="w"> </span><span class="p">[[</span><span class="n">org.clojure/clojure</span><span class="w"> </span><span class="s">"1.6.0"</span><span class="p">]</span><span class="w">
                 </span><span class="p">[</span><span class="n">org.clojure/clojurescript</span><span class="w"> </span><span class="s">"0.0-2173"</span><span class="p">]]</span><span class="w">
  </span><span class="no">:plugins</span><span class="w"> </span><span class="p">[[</span><span class="n">lein-cljsbuild</span><span class="w"> </span><span class="s">"1.0.2"</span><span class="p">]])</span></code></pre></figure>

<p>Next, add your Clojurescript compiler options after the line <code class="language-plaintext highlighter-rouge">:plugins [[lein-cljsbuild "1.0.2"]]</code>.</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="w">  </span><span class="no">:cljsbuild</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="no">:builds</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="no">:source-paths</span><span class="w"> </span><span class="p">[</span><span class="s">"src/cljs_raphael"</span><span class="p">]</span><span class="w">
        </span><span class="no">:compiler</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="no">:output-to</span><span class="w"> </span><span class="s">"resources/js/app.js"</span><span class="w">
          </span><span class="no">:optimizations</span><span class="w"> </span><span class="no">:whitespace</span><span class="w">
          </span><span class="no">:pretty-print</span><span class="w"> </span><span class="n">true</span><span class="p">}}]}</span></code></pre></figure>

<p>With this configuration, the compiler will look in the <code class="language-plaintext highlighter-rouge">src/cljs_raphael</code> directory for Clojurescript files and compile them to <code class="language-plaintext highlighter-rouge">resources/js/app.js</code>.</p>

<p>At this point, run <code class="language-plaintext highlighter-rouge">lein deps</code> to get our Clojurescript dependency installed.</p>

<h2 id="external-js-files-and-indexhtml">External JS files and index.html</h2>

<p>In order for us to write Clojurescript that uses Raphael, we need to include the Raphael SVG library and its corresponding graph library. Download <a href="http://github.com/DmitryBaranovskiy/raphael/raw/master/raphael-min.js" target="_blank">raphael-min.js</a>, <a href="http://github.com/DmitryBaranovskiy/g.raphael/raw/master/min/g.raphael-min.js" target="_blank">g.raphael-min.js</a>, and <a href="http://github.com/DmitryBaranovskiy/g.raphael/raw/master/min/g.pie-min.js" target="_blank">g.pie-min.js</a>, and place them inside of your <code class="language-plaintext highlighter-rouge">resources/js</code> directory.</p>

<p>We also need an <code class="language-plaintext highlighter-rouge">index.html</code> page onto which our Clojurescript can render graphs! Add the following into a new file, <code class="language-plaintext highlighter-rouge">resources/index.html</code>:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"X-UA-Compatible"</span> <span class="na">content=</span><span class="s">"IE=edge"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Clojurescript/Raphael Funsies!<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"my-pie"</span> <span class="na">style=</span><span class="s">"height: 400px;"</span><span class="nt">&gt;&lt;/div&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/raphael-min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/g.raphael-min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/g.pie-min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/app.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<p>Let’s put something on the page using Clojurescript. Make a new file, <code class="language-plaintext highlighter-rouge">src/cljs_raphael/pie.cljs</code>, and put this in it:</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="nf">ns</span><span class="w"> </span><span class="n">cljs-raphael.pie</span><span class="p">)</span><span class="w">

</span><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">[</span><span class="n">my-pie</span><span class="w"> </span><span class="p">(</span><span class="nf">.getElementById</span><span class="w"> </span><span class="n">js/document</span><span class="w"> </span><span class="s">"my-pie"</span><span class="p">)]</span><span class="w">
    </span><span class="p">(</span><span class="nf">set!</span><span class="w"> </span><span class="p">(</span><span class="nf">.-innerHTML</span><span class="w"> </span><span class="n">my-pie</span><span class="p">)</span><span class="w"> </span><span class="s">"Yeehaw!"</span><span class="p">)))</span><span class="w">

</span><span class="p">(</span><span class="nf">set!</span><span class="w"> </span><span class="p">(</span><span class="nf">.-onload</span><span class="w"> </span><span class="n">js/window</span><span class="p">)</span><span class="w"> </span><span class="n">init</span><span class="p">)</span></code></pre></figure>

<p>Next, run <code class="language-plaintext highlighter-rouge">lein cljsbuild auto</code>. This will compile your Clojurescript file into Javascript. If you leave it running, it will watch the <code class="language-plaintext highlighter-rouge">src/cljs_raphael</code> directory and recompile anytime a .cljs file is saved.</p>

<p>Open your <code class="language-plaintext highlighter-rouge">resources/index.html</code> in a browser. You should see “Yeehaw!” on the page.</p>

<h2 id="making-an-animated-pie-chart">Making an Animated Pie Chart</h2>

<p>Chart-making time! I will create a pie chart based on <a href="http://g.raphaeljs.com/piechart2.html" target="_blank">this demo chart</a>.</p>

<p>First, go to your <code class="language-plaintext highlighter-rouge">pie.cljs</code> file and update the <code class="language-plaintext highlighter-rouge">init</code> function to look like this:</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">[</span><span class="n">r</span><span class="w"> </span><span class="p">(</span><span class="nf">js/Raphael</span><span class="w"> </span><span class="s">"my-pie"</span><span class="p">)</span><span class="w">
        </span><span class="n">pie</span><span class="w"> </span><span class="p">(</span><span class="nf">.piechart</span><span class="w">
             </span><span class="n">r</span><span class="w"> </span><span class="mi">320</span><span class="w"> </span><span class="mi">240</span><span class="w"> </span><span class="mi">100</span><span class="w">
             </span><span class="p">(</span><span class="nf">array</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w">
             </span><span class="p">(</span><span class="nf">js-obj</span><span class="w"> </span><span class="s">"legend"</span><span class="w"> </span><span class="p">(</span><span class="nf">array</span><span class="w"> </span><span class="s">"with-55"</span><span class="w"> </span><span class="s">"with-20"</span><span class="w"> </span><span class="s">"so on..."</span><span class="p">)</span><span class="w">
                     </span><span class="s">"legendpos"</span><span class="w"> </span><span class="s">"west"</span><span class="p">))]</span><span class="w">
        </span><span class="p">(</span><span class="nf">other-functions-in-scope</span><span class="p">)))</span></code></pre></figure>

<p>This corresponds to the following Javascript:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="nc">Raphael</span><span class="p">(</span><span class="dl">"</span><span class="s2">my-pie</span><span class="dl">"</span><span class="p">),</span>
    <span class="nx">pie</span> <span class="o">=</span> <span class="nx">r</span><span class="p">.</span><span class="nf">piechart</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="p">[</span><span class="mi">55</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">{</span>
            <span class="na">legend</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">with-55</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">with-20</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">so on...</span><span class="dl">"</span><span class="p">],</span>
            <span class="na">legendpos</span><span class="p">:</span> <span class="dl">"</span><span class="s2">west</span><span class="dl">"</span>
          <span class="p">});</span>
<span class="nf">otherFunctionsInScope</span><span class="p">();</span></code></pre></figure>

<p>Note that in Clojurescript, we use <code class="language-plaintext highlighter-rouge">(let [r "some-value"] (code-to-execute-in-scope))</code> syntax to define Javascript scope variables. Also note the use of <code class="language-plaintext highlighter-rouge">(array)</code> and <code class="language-plaintext highlighter-rouge">(js-obj)</code> functions to create those particular JS data structures in Clojurescript.</p>

<p>Take another look at the dot and dot-dash characters in the Clojurescript above. Something like <code class="language-plaintext highlighter-rouge">(.log js/console "Yeehaw")</code>, with just a dot, correponds to calling an object’s function. Meanwhile, something like <code class="language-plaintext highlighter-rouge">(.-onload js/window)</code> corresponds to getting or setting an object’s property (here, the window object’s onload property).</p>

<p>Now let’s add a title. Replace <code class="language-plaintext highlighter-rouge">(other-functions-in-scope)</code> with this:</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="nf">.attr</span><span class="w">
 </span><span class="p">(</span><span class="nf">.text</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="mi">320</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="s">"Clojurescript/Raphael Demo"</span><span class="p">)</span><span class="w">
 </span><span class="p">(</span><span class="nf">js-obj</span><span class="w"> </span><span class="s">"font"</span><span class="w"> </span><span class="s">"20px sans-serif"</span><span class="p">))</span></code></pre></figure>

<p>This corresponds to:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">r</span><span class="p">.</span><span class="nf">text</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="dl">"</span><span class="s2">Clojurescript/Raphael Demo</span><span class="dl">"</span><span class="p">).</span><span class="nf">attr</span><span class="p">({</span> <span class="na">font</span><span class="p">:</span> <span class="dl">"</span><span class="s2">20px sans-serif</span><span class="dl">"</span> <span class="p">});</span></code></pre></figure>

<p>And refresh your page. You should see your pie chart, a legend, and the title!</p>

<p>Next, let’s add the fun hover effect. Start by adding this function above <code class="language-plaintext highlighter-rouge">init</code>:</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">sector-mousein</span><span class="w">
  </span><span class="p">[]</span><span class="w">
  </span><span class="p">(</span><span class="nf">this-as</span><span class="w"> </span><span class="n">this</span><span class="w">
   </span><span class="p">(</span><span class="nf">.stop</span><span class="w"> </span><span class="p">(</span><span class="nf">.-sector</span><span class="w"> </span><span class="n">this</span><span class="p">))</span><span class="w">
   </span><span class="p">(</span><span class="nf">.scale</span><span class="w"> </span><span class="p">(</span><span class="nf">.-sector</span><span class="w"> </span><span class="n">this</span><span class="p">)</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="p">(</span><span class="nf">.-cx</span><span class="w"> </span><span class="n">this</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">.-cy</span><span class="w"> </span><span class="n">this</span><span class="p">))</span><span class="w">
   </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">.-label</span><span class="w"> </span><span class="n">this</span><span class="p">)</span><span class="w">
     </span><span class="p">(</span><span class="nf">do</span><span class="w">
       </span><span class="p">(</span><span class="nf">.stop</span><span class="w"> </span><span class="p">(</span><span class="nb">nth</span><span class="w"> </span><span class="p">(</span><span class="nf">.-items</span><span class="w"> </span><span class="p">(</span><span class="nf">.-label</span><span class="w"> </span><span class="n">this</span><span class="p">))</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w">
       </span><span class="p">(</span><span class="nf">.attr</span><span class="w"> </span><span class="p">(</span><span class="nb">nth</span><span class="w"> </span><span class="p">(</span><span class="nf">.-items</span><span class="w"> </span><span class="p">(</span><span class="nf">.-label</span><span class="w"> </span><span class="n">this</span><span class="p">))</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">
              </span><span class="p">(</span><span class="nf">js-obj</span><span class="w"> </span><span class="s">"r"</span><span class="w"> </span><span class="mf">7.5</span><span class="p">))</span><span class="w">
       </span><span class="p">(</span><span class="nf">.attr</span><span class="w"> </span><span class="p">(</span><span class="nb">nth</span><span class="w"> </span><span class="p">(</span><span class="nf">.-items</span><span class="w"> </span><span class="p">(</span><span class="nf">.-label</span><span class="w"> </span><span class="n">this</span><span class="p">))</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">
              </span><span class="p">(</span><span class="nf">js-obj</span><span class="w"> </span><span class="s">"font-weight"</span><span class="w"> </span><span class="mi">800</span><span class="p">))))))</span></code></pre></figure>

<p>This animates the wedges and corresponding labels when we hover over a pie chart wedge. In order to make this work, I used the <code class="language-plaintext highlighter-rouge">this-as</code> macro to open up access to <code class="language-plaintext highlighter-rouge">this</code>. Here is the corresponding Javascript:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nf">function </span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">sector</span><span class="p">.</span><span class="nf">stop</span><span class="p">();</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">sector</span><span class="p">.</span><span class="nf">scale</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">cx</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">cy</span><span class="p">);</span>

  <span class="nf">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">label</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">label</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">stop</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">label</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">attr</span><span class="p">({</span> <span class="na">r</span><span class="p">:</span> <span class="mf">7.5</span> <span class="p">});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">label</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">attr</span><span class="p">({</span> <span class="dl">"</span><span class="s2">font-weight</span><span class="dl">"</span><span class="p">:</span> <span class="mi">800</span> <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Next, add this function also above init. This is the function that will be called when the mouse leaves a wedge.</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">sector-mouseout</span><span class="w">
  </span><span class="p">[]</span><span class="w">
  </span><span class="p">(</span><span class="nf">this-as</span><span class="w"> </span><span class="n">this</span><span class="w">
   </span><span class="p">(</span><span class="nf">.animate</span><span class="w">
    </span><span class="p">(</span><span class="nf">.-sector</span><span class="w"> </span><span class="n">this</span><span class="p">)</span><span class="w">
    </span><span class="p">(</span><span class="nf">js-obj</span><span class="w"> </span><span class="s">"transform"</span><span class="w"> </span><span class="p">(</span><span class="nb">str</span><span class="w"> </span><span class="s">"s1 1 "</span><span class="w"> </span><span class="p">(</span><span class="nf">.-cx</span><span class="w"> </span><span class="n">this</span><span class="p">)</span><span class="w"> </span><span class="s">" "</span><span class="w"> </span><span class="p">(</span><span class="nf">.-cy</span><span class="w"> </span><span class="n">this</span><span class="p">)))</span><span class="w">
    </span><span class="mi">500</span><span class="w"> </span><span class="s">"bounce"</span><span class="p">)</span><span class="w">
   </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">.-label</span><span class="w"> </span><span class="n">this</span><span class="p">)</span><span class="w">
     </span><span class="p">(</span><span class="nf">do</span><span class="w">
       </span><span class="p">(</span><span class="nf">.animate</span><span class="w"> </span><span class="p">(</span><span class="nb">nth</span><span class="w"> </span><span class="p">(</span><span class="nf">.-items</span><span class="w"> </span><span class="p">(</span><span class="nf">.-label</span><span class="w"> </span><span class="n">this</span><span class="p">))</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">js-obj</span><span class="w"> </span><span class="s">"r"</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="mi">500</span><span class="w"> </span><span class="s">"bounce"</span><span class="p">)</span><span class="w">
       </span><span class="p">(</span><span class="nf">.attr</span><span class="w"> </span><span class="p">(</span><span class="nb">nth</span><span class="w"> </span><span class="p">(</span><span class="nf">.-items</span><span class="w"> </span><span class="p">(</span><span class="nf">.-label</span><span class="w"> </span><span class="n">this</span><span class="p">))</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">js-obj</span><span class="w"> </span><span class="s">"font-weight"</span><span class="w"> </span><span class="mi">400</span><span class="p">))))))</span></code></pre></figure>

<p>Lastly, add the following line inside <code class="language-plaintext highlighter-rouge">init</code> to bind those event handler functions to the pie chart wedges.</p>

<figure class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="nf">.hover</span><span class="w"> </span><span class="n">pie</span><span class="w"> </span><span class="n">sector-mousein</span><span class="w"> </span><span class="n">sector-mouseout</span><span class="p">)</span></code></pre></figure>

<p>Refresh your page in the browser. At this point, you should have a <a href="http://annejohnson.github.io/cljs-raphael" target="_blank">sweet animated pie chart</a> - powered by the magical intersection of Clojurescript, the JVM, and interop with RaphaelJS. Get up and start dancing!</p>]]></content><author><name></name></author><category term="clojurescript" /><category term="clojure" /><summary type="html"><![CDATA[When I started using Clojurescript a few weeks ago, it was interesting learning how to translate between the two very different syntaxes of Javascript and Clojurescript. I’m going to share what I learned as I demonstrate how to use Clojurescript to make charts using Raphael.js’s chart library. Code is available here.]]></summary></entry><entry><title type="html">Strange Loop 2014</title><link href="https://annekjohnson.com/blog/2014/09/strange-loop-2014/index.html" rel="alternate" type="text/html" title="Strange Loop 2014" /><published>2014-09-29T22:34:18+02:00</published><updated>2014-09-29T22:34:18+02:00</updated><id>https://annekjohnson.com/blog/2014/09/strange-loop-2014/strange-loop-2014</id><content type="html" xml:base="https://annekjohnson.com/blog/2014/09/strange-loop-2014/index.html"><![CDATA[<p>I went to a tech conference called <a href="https://thestrangeloop.com/" target="_blank">Strange Loop</a> last week. It takes place once a year in Saint Louis, Missouri, and features talks by the creators and earliest users of cutting-edge technologies. I’ve heard that the technologies you learn about at Strange Loop are those that people will be using widely in a couple of years. Strange Loop is a way to explore this exciting future.</p>

<p>This was my very first tech conference, and I had an <strong>amazing</strong> time! I overloaded my brain with talks about new and mind-bending technologies, and I met more brilliant people than I can count.</p>

<h2 id="highlights">Highlights</h2>

<p>I could go on and on for a very long time about all that I enjoyed at Strange Loop. I’ll try to confine everything within a few bullet points.</p>

<ul>
  <li><a href="http://www.manning.com/poweredbyjavascript/" target="_blank"><strong>Powered by Javascript</strong></a>: a pre-conference event all about Javascript. Some talks covered new+upcoming features in Javascript. Others were about Javascript reaching into new realms of development. Some of my favorite talks were:
    <ul>
      <li><strong>Virtual Reality in JavaScript</strong> by <a href="https://github.com/dmarcos" target="_blank">Diego Marcos</a>. Javascript meets the <a href="http://www.oculus.com/" target="_blank">Oculus Rift</a>!</li>
      <li><strong>Closures and Currying in JavaScript</strong> by <a href="https://twitter.com/gneatgeek" target="_blank">Rory Hardy</a>. Finally those frigging things make more sense.</li>
      <li><strong>Build mobile apps with Javascript using the <a href="http://ionicframework.com/" target="_blank">Ionic Framework</a></strong> by <a href="https://twitter.com/gnomeontherun" target="_blank">Jeremy Wilken</a>. Javascript as a tool for creating native-quality mobile apps.</li>
    </ul>
  </li>
  <li><a href="http://www.citymuseum.org/" target="_blank"><strong>The City Museum!</strong></a> Strange Loop rented out the entirety of Saint Louis’s quirkiest attraction for a night. I had a great time climbing around in the museum’s otherworldly structures with fellow Strange Loop attendees.</li>
  <li><strong>Amazing Strange Loop talks.</strong> A short list of those that were most inspiring to me:
    <ul>
      <li><a href="https://www.youtube.com/watch?v=KKaHkkpdHxg" target="_blank"><strong>Nashorn: implementing a dynamic language runtime on the JVM</strong></a> by <a href="https://twitter.com/asz" target="_blank">Attila Szegedi</a>. He talked about the process of getting a dynamically typed language to compile into JVM bytecode. My favorite phrase from the talk is definitely <strong>Unwarranted Optimism Exception</strong>.</li>
      <li><a href="https://www.youtube.com/watch?v=FJpb1j2SWfA" target="_blank"><strong>Art.js: Transfigure Data to Create 21st Century Art</strong></a> by <a href="https://twitter.com/supersgp" target="_blank">Sarah Groff-Palermo</a>. She inspired me to think more creatively about data - that it can be used not just to make highly structured presentations, but also art - and all in code.</li>
      <li><a href="https://www.youtube.com/watch?v=QAwbjMdXj-Y" target="_blank"><strong>DOMStep: Audio Synthesis, AI and a JavaScript Dance Party</strong></a> by <a href="https://twitter.com/jergason" target="_blank">Jamison Dance</a>. Extremely entertaining talk, and who knew that browsers have an audio API? Well, I didn’t…</li>
      <li><a href="https://www.youtube.com/watch?v=9xbrMTieJa0" target="_blank"><strong>Democratizing Hardware</strong></a> by <a href="https://twitter.com/voodootikigod" target="_blank">Chris Williams</a>. As a result of this talk, I’ve added “small NodeBot project” to my list of To-Do’s.</li>
      <li><a href="https://www.youtube.com/watch?v=0IQlpFWTFbM" target="_blank"><strong>You can be a kernel hacker!</strong></a> by <a href="https://twitter.com/b0rk" target="_blank">Julia Evans</a>. Hilarious and informative, all at once! Offered great advice for learning how to dig deeper into Linux OS code.</li>
    </ul>
  </li>
  <li><strong>The Strange Loop Keynotes</strong>. Joe Armstrong talked about <a href="https://www.youtube.com/watch?v=lKXe3HUG2l4" target="_blank">“the mess we’re in”</a>: how we’ve gotten ourselves into a trench of bloated code and complexity, and how computers have more possible states than the number of atoms in gajillions of universes. Nada Amin talked about <a href="https://www.youtube.com/watch?v=SrKj4hYic5A" target="_blank">venturing into “meta-levels”</a> with a reflective programming language called Black. Stephen Wolfram talked about the new <a href="https://www.youtube.com/watch?v=EjCWdsrVcBM" target="_blank">Wolfram programming language</a>. And, to wrap it up, a group of speakers delivered the final keynote as a <a href="https://www.youtube.com/watch?v=3_zW63dcZB0" target="_blank">robot dance party</a>. Catchy music and dancing hardware, all powered by Clojure.</li>
</ul>

<h2 id="diversity-scholarship">Diversity Scholarship</h2>
<p>I attended Strange Loop with the help of a diversity scholarship. Many very generous individuals and companies contributed to the scholarship pool - and enabled Strange Loop to dramatically increase the percent of minority attendees.</p>

<h4 id="to-those-generous-people">To those generous people:</h4>
<p><strong>THANK YOU!</strong> This experience meant so much to me! Not just for all that I learned, but also for the rare opportunity to see diversity in technology. And, rarer still, for the opportunity to see people from diverse backgrounds <strong>giving talks</strong> and <strong>being leaders</strong> in the industry. I feel revitalized and inspired. I can’t wait to pay this experience forward.</p>]]></content><author><name></name></author><category term="programming" /><category term="technology" /><category term="conference" /><summary type="html"><![CDATA[I went to a tech conference called Strange Loop last week. It takes place once a year in Saint Louis, Missouri, and features talks by the creators and earliest users of cutting-edge technologies. I’ve heard that the technologies you learn about at Strange Loop are those that people will be using widely in a couple of years. Strange Loop is a way to explore this exciting future.]]></summary></entry></feed>